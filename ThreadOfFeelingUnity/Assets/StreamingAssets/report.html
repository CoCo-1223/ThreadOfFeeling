<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ìƒí™© ì¤‘ì‹¬ ê°ì • ì´í•´ ì²´í¬ë¦¬ìŠ¤íŠ¸</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f3f4f6;
      color: #111827;
    }
    body {
      margin: 0;
      padding: 1.5rem;
    }
    .app-container {
      max-width: 980px;
      margin: 0 auto;
      background: #ffffff;
      border-radius: 16px;
      padding: 1.5rem 1.75rem 2rem;
      box-shadow: 0 12px 30px rgba(15, 23, 42, 0.12);
    }
    h1 {
      font-size: 1.6rem;
      margin: 0 0 0.25rem;
    }
    p.description {
      margin-top: 0;
      font-size: 0.9rem;
      color: #4b5563;
    }
    .badge {
      display: inline-block;
      font-size: 0.75rem;
      padding: 0.15rem 0.55rem;
      border-radius: 999px;
      background: #eff6ff;
      color: #1d4ed8;
      margin-right: 0.35rem;
    }
    .notice {
      margin-top: 0.4rem;
      font-size: 0.76rem;
      color: #6b7280;
      background: #f9fafb;
      border-radius: 8px;
      padding: 0.45rem 0.6rem;
      border: 1px dashed #e5e7eb;
    }
    .notice strong {
      color: #b91c1c;
    }
    .score-scale {
      font-size: 0.82rem;
      color: #6b7280;
      margin-bottom: 0.75rem;
    }
    .controls-bar {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin: 0.5rem 0 0.75rem;
    }
    .btn {
      border: 1px solid #d1d5db;
      background: #f9fafb;
      border-radius: 999px;
      padding: 0.4rem 0.8rem;
      font-size: 0.82rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      color: #111827;
      transition: background 0.1s, border-color 0.1s;
    }
    .btn-primary {
      background: #2563eb;
      border-color: #1d4ed8;
      color: #f9fafb;
    }
    .btn:hover {
      background: #e5e7eb;
    }
    .btn-primary:hover {
      background: #1d4ed8;
    }
    .btn span.icon {
      font-size: 0.9em;
    }
    input[type="file"] {
      display: none;
    }
    .section-card {
      border-radius: 14px;
      border: 1px solid #e5e7eb;
      padding: 1rem 1rem 0.8rem;
      margin-top: 1rem;
      background: #f9fafb;
    }
    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.6rem;
    }
    .section-title {
      font-weight: 600;
      font-size: 1rem;
      color: #111827;
    }
    .section-score {
      font-size: 0.85rem;
      color: #4b5563;
    }
    .section-score span {
      font-weight: 600;
      color: #111827;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.9rem;
    }
    th, td {
      border-bottom: 1px solid #e5e7eb;
      padding: 0.35rem 0.3rem;
      vertical-align: top;
    }
    th {
      background: #f3f4f6;
      font-weight: 600;
      font-size: 0.84rem;
      color: #4b5563;
      text-align: center;
    }
    th.item-header {
      text-align: left;
      width: 68%;
    }
    td.item-label {
      padding-right: 0.5rem;
    }
    .item-code {
      font-size: 0.78rem;
      color: #6b7280;
      margin-right: 0.35rem;
      white-space: nowrap;
    }
    .radio-group {
      display: flex;
      justify-content: center;
      gap: 0.4rem;
    }
    .radio-group label {
      font-size: 0.8rem;
      color: #4b5563;
      display: inline-flex;
      align-items: center;
      gap: 0.15rem;
      cursor: pointer;
    }
    textarea.memo {
      width: 100%;
      min-height: 60px;
      margin-top: 0.5rem;
      border-radius: 8px;
      border: 1px solid #e5e7eb;
      padding: 0.5rem 0.6rem;
      font-size: 0.85rem;
      resize: vertical;
    }
    .memo-label {
      margin-top: 0.5rem;
      font-size: 0.82rem;
      color: #4b5563;
    }
    .global-summary {
      margin-top: 1.5rem;
      padding-top: 1rem;
      border-top: 1px solid #e5e7eb;
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      justify-content: space-between;
      align-items: flex-start;
    }
    .global-score-box {
      border-radius: 12px;
      padding: 0.75rem 1rem;
      background: #eff6ff;
      border: 1px solid #bfdbfe;
      min-width: 220px;
    }
    .global-score-box h3 {
      margin: 0 0 0.5rem;
      font-size: 0.95rem;
    }
    .global-score-box p {
      margin: 0.1rem 0;
      font-size: 0.9rem;
      color: #1f2937;
    }
    .global-score-box span.value {
      font-weight: 700;
    }
    .global-textarea-wrapper {
      flex: 1;
      min-width: 240px;
    }
    .global-textarea-wrapper label {
      display: block;
      font-size: 0.85rem;
      color: #4b5563;
      margin-bottom: 0.25rem;
    }
    .global-textarea-wrapper textarea {
      width: 100%;
      min-height: 80px;
      border-radius: 8px;
      border: 1px solid #e5e7eb;
      padding: 0.5rem 0.6rem;
      font-size: 0.85rem;
      resize: vertical;
    }
    .meta {
      margin-top: 0.75rem;
      font-size: 0.76rem;
      color: #9ca3af;
      text-align: right;
    }

    @media (max-width: 640px) {
      body {
        padding: 0.75rem;
      }
      .app-container {
        padding: 1rem 1rem 1.25rem;
      }
      th.item-header {
        width: 58%;
      }
      .radio-group {
        gap: 0.25rem;
      }
      .radio-group label {
        font-size: 0.78rem;
      }
      .controls-bar {
        flex-direction: column;
        align-items: flex-start;
      }
    }

    @media print {
      body {
        padding: 0;
        background: #ffffff;
      }
      .app-container {
        box-shadow: none;
        border-radius: 0;
      }
      .controls-bar, .meta {
        display: none;
      }
    }
  </style>
</head>
<body>
  <div class="app-container">
    <div>
      <span class="badge">ìƒí™© ì¤‘ì‹¬</span>
      <span class="badge">ê°ì • ì´í•´ í‰ê°€</span>
    </div>
    <h1>ìƒí™© ì¤‘ì‹¬ ê°ì • ì´í•´ ì²´í¬ë¦¬ìŠ¤íŠ¸</h1>
    <p class="description">
      ìí ì•„ë™ì˜ ê°ì • ì¸ì‹ ëŠ¥ë ¥ì„
      <strong>ìƒí™©Â·í–‰ë™Â·ë§íˆ¬Â·ê²°ê³¼Â·ì‚¬íšŒì  ë§¥ë½</strong> ì¤‘ì‹¬ìœ¼ë¡œ í‰ê°€í•˜ê¸° ìœ„í•œ ê´€ì°°ììš© ì²´í¬ë¦¬ìŠ¤íŠ¸ì…ë‹ˆë‹¤.
    </p>
    <p class="notice">
      <strong>ì£¼ì˜:</strong> ë³¸ ì²´í¬ë¦¬ìŠ¤íŠ¸ëŠ” ê²Œì„ í™œë™ì„ í†µí•œ ìƒí™© ì¤‘ì‹¬ ê°ì • ì¸ì‹ í–¥ìƒì„ í™•ì¸í•˜ê¸° ìœ„í•œ êµìœ¡Â·ì¤‘ì¬ìš© ê´€ì°° ë„êµ¬ì´ë©°,
      ì˜í•™ì Â·ì„ìƒì  ì§„ë‹¨ ê¸°ëŠ¥ì„ ì œê³µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
    </p>
    <div class="score-scale">
      ì ìˆ˜ ê¸°ì¤€: N/A = ê´€ë ¨ ì—†ìŒ / 0ì  = ì „í˜€ ìˆ˜í–‰ ëª»í•¨ / 1ì  = ë³´í˜¸ìì˜ êµ¬ì²´ì ì¸ ì„¤ëª…ìœ¼ë¡œ ìˆ˜í–‰ / 2ì  = ì¼ë¶€ ë‹¨ì„œë¥¼ í™œìš©í•´ ë¶ˆì™„ì „í•œ ìˆ˜í–‰ / 3ì  = ë‹¨ì„œë¥¼ ì¼ê´€ë˜ê²Œ í™œìš©í•´ ì •í™•íˆ ìˆ˜í–‰
    </div>

    <div class="controls-bar">
      <button class="btn btn-primary" id="btn-export">
        <span class="icon">ğŸ’¾</span> ë°ì´í„° ë‚´ë³´ë‚´ê¸° (JSON)
      </button>
      <label class="btn" for="file-import">
        <span class="icon">ğŸ“‚</span> ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° (JSON)
      </label>
      <input type="file" id="file-import" accept="application/json" />
      <button class="btn" id="btn-print">
        <span class="icon">ğŸ–¨ï¸</span> ì¸ì‡„ / PDF ì €ì¥
      </button>
    </div>

    <div id="sections-container"></div>

    <div class="global-summary">
      <div class="global-score-box" id="global-score-box">
        <h3>ì „ì²´ ì ìˆ˜ ìš”ì•½</h3>
        <p>ì´ì : <span class="value" id="global-total">0</span>ì </p>
        <p>í‰ê· ì ìˆ˜: <span class="value" id="global-avg">0.0</span>ì  (0~3)</p>
        <p>ì‘ë‹µí•œ ë¬¸í•­ ìˆ˜: <span class="value" id="global-count">0</span>ê°œ</p>
      </div>
      <div class="global-textarea-wrapper">
        <label for="global-notes">ì¢…í•© ì˜ê²¬ / ê°•ì  Â· ë³´ì™„ í•„ìš” ì˜ì—­ ë©”ëª¨</label>
        <textarea id="global-notes" placeholder="ì˜ˆ: ìƒí™© ë‹¨ì„œëŠ” ì˜ ì‚¬ìš©í•˜ëŠ” í¸ì´ë‚˜, ì‚¬íšŒì  ê´€ê³„ ë§¥ë½(ì¹œêµ¬/ë‚¯ì„  ì‚¬ëŒ)ì— ë”°ë¥¸ ê°ì • ì¶”ë¡ ì´ ì–´ë ¤ì›Œ ë³´ì„."></textarea>
      </div>
    </div>

    <div class="meta">
      ë³¸ ì²´í¬ë¦¬ìŠ¤íŠ¸ëŠ” Narrative-based intervention, Social Information Processing, ToM, SCERTS, ESDM ë“± ì—°êµ¬Â·ëª¨ë¸ì„ ë°”íƒ•ìœ¼ë¡œ êµ¬ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
    </div>
  </div>

  <script>
    const checklistData = [
      {
        id: "sec1",
        title: "1. ìƒí™© ë‹¨ì„œ ê¸°ë°˜ ê°ì • ì¶”ë¡  ëŠ¥ë ¥",
        items: [
          { code: "1-1-1", text: "ìƒí™© ì„¤ëª…ë§Œìœ¼ë¡œ ì¸ë¬¼ì´ ì–´ë–¤ ê°ì •ì„ ëŠë‚„ì§€ ì˜ˆì¸¡í•œë‹¤." },
          { code: "1-1-2", text: "ì‚¬ê±´ì˜ ì›ì¸(ìƒì–´ë²„ë¦¼, ì‹¤íŒ¨, í˜¼ë‚¨ ë“±)ì„ ê°ì •ê³¼ ìì—°ìŠ¤ëŸ½ê²Œ ì—°ê²°í•œë‹¤." },
          { code: "1-1-3", text: "ì¸ë¬¼ì´ ëŠë‚„ ìˆ˜ ìˆëŠ” ê°ì •ì„ í•œ ê°€ì§€ ì´ìƒ ë§í•˜ê±°ë‚˜ ì„ íƒí•œë‹¤." },
          { code: "1-2-1", text: "ì‚¬ê±´ì˜ ê²°ë§ì„ ë³´ê³  ê°ì •ì˜ ë³€í™”ë¥¼ ì¶”ì¸¡í•œë‹¤." },
          { code: "1-2-2", text: "ê¸ì •ì  ê²°ê³¼/ë¶€ì •ì  ê²°ê³¼ì— ë”°ë¼ ê°ì •ì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŒì„ êµ¬ë¶„í•œë‹¤." },
          { code: "1-2-3", text: "ê²°ë§ì´ ë°”ë€Œë©´ ê°ì • ì„ íƒë„ ìƒí™©ì— ë§ê²Œ ìœ ì—°í•˜ê²Œ ë°”ê¾¼ë‹¤." },
          { code: "1-3-1", text: "ìœ„í—˜ ìƒí™©/í‰ì˜¨í•œ ìƒí™©ì„ êµ¬ë³„í•˜ê³  ê·¸ì— ë§ëŠ” ê°ì •ì„ ì˜ˆì¸¡í•œë‹¤." },
          { code: "1-3-2", text: "ë‹¨ì„œê°€ ì ì€ ëª¨í˜¸í•œ ìƒí™©ì—ì„œë„ ë¬´ì‘ìœ„ê°€ ì•„ë‹Œ í•©ë¦¬ì ì¸ ì¶”ë¡ ì„ í•œë‹¤." },
          { code: "1-3-3", text: "ìƒí™©ì˜ ê¸Â·ë¶€ì • ë¶„ìœ„ê¸°(ë¶„ìœ„ê¸°, ë§¥ë½)ë¥¼ ìì—°ìŠ¤ëŸ½ê²Œ íŒŒì•…í•œë‹¤." }
        ]
      },
      {
        id: "sec2",
        title: "2. í–‰ë™ ë‹¨ì„œ ê¸°ë°˜ ê°ì • ì¶”ë¡  ëŠ¥ë ¥ (í‘œì • ì œì™¸)",
        items: [
          { code: "2-1-1", text: "ì¸ë¬¼ì´ ë›°ì–´ê°/ë¬¼ëŸ¬ë‚¨/ì¶• ì²˜ì§ ë“±ì˜ í–‰ë™ì„ ë³´ê³  ê°ì •ì„ ì¶”ì¸¡í•œë‹¤." },
          { code: "2-1-2", text: "í™œë™ ìˆ˜ì¤€ì´ ë‚®ì•„ì§€ë©´ ìŠ¬í””Â·ì§€ì¹¨ê³¼ ê°™ì€ ê°ì •ì„ ì¶”ì •í•œë‹¤." },
          { code: "2-1-3", text: "í™œë™ ìˆ˜ì¤€ì´ ë†’ì•„ì§€ë©´ ê¸°ì¨Â·í¥ë¶„ê³¼ ê°™ì€ ê°ì •ì„ ì¶”ì •í•œë‹¤." },
          { code: "2-2-1", text: "ì´ì „ê³¼ ì´í›„ì˜ í–‰ë™ ë³€í™”ë¥¼ ê°ì • ë³€í™”ì™€ ì—°ê²°í•˜ì—¬ ì´í•´í•œë‹¤." },
          { code: "2-2-2", text: "ê°™ì€ í–‰ë™ì´ë¼ë„ ìƒí™©ì— ë”°ë¼ ë‹¤ë¥¸ ê°ì •ì´ ë  ìˆ˜ ìˆìŒì„ ì´í•´í•œë‹¤." },
          { code: "2-2-3", text: "ê¸´ì¥ëœ í–‰ë™(ì† ê½‰ ì¥ , ë°œ ë™ë™ ë“±)ì„ ë¶ˆì•ˆÂ·í™”ë‚¨ ë“±ì˜ ê°ì •ê³¼ ì—°ê²°í•œë‹¤." }
        ]
      },
      {
        id: "sec3",
        title: "3. ì–¸ì–´Â·ë§íˆ¬ ë‹¨ì„œ ê¸°ë°˜ ê°ì • ì´í•´",
        items: [
          { code: "3-1-1", text: "ëª©ì†Œë¦¬ê°€ ì‘ê³  ëŠë¦´ ë•Œ ìŠ¬í””Â·ì‹¤ë§ ë“±ì˜ ê°ì •ìœ¼ë¡œ ì¶”ì •í•œë‹¤." },
          { code: "3-1-2", text: "ëª©ì†Œë¦¬ê°€ í¬ê³  ë¹ ë¥¼ ë•Œ í™”ë‚¨Â·í¥ë¶„ ë“±ì˜ ê°ì •ìœ¼ë¡œ ì¶”ì •í•œë‹¤." },
          { code: "3-1-3", text: "ë–¨ë¦¼Â·ë¨¸ë­‡ê±°ë¦¼ì´ ìˆëŠ” ë§íˆ¬ë¥¼ ë¶ˆì•ˆÂ·ë‘ë ¤ì›€ ë“±ìœ¼ë¡œ ì—°ê²°í•œë‹¤." },
          { code: "3-2-1", text: "ë¶€ì •ì  ë‹¨ì–´ë‚˜ ê±±ì • í‘œí˜„ì„ ë¶€ì •ê°ì •ê³¼ ì—°ê²°í•œë‹¤." },
          { code: "3-2-2", text: "ê¸ì •ì  í‘œí˜„(â€œì¢‹ì•„!â€, â€œëë‹¤!â€ ë“±)ì„ ê¸°ì¨Â·ì•ˆë„ê°ê³¼ ì—°ê²°í•œë‹¤." },
          { code: "3-2-3", text: "â€œì–´ë–¡í•˜ì§€â€¦â€, â€œí°ì¼ ë‚¬ë‹¤â€¦â€ì™€ ê°™ì€ ëŒ€ì‚¬ì˜ ì •ì„œë¥¼ íŒŒì•…í•œë‹¤." }
        ]
      },
      {
        id: "sec4",
        title: "4. ì‚¬íšŒì  ë§¥ë½ ë° ê´€ê³„ ê¸°ë°˜ ê°ì • ì´í•´",
        items: [
          { code: "4-1-1", text: "ìƒëŒ€ê°€ ì¹œêµ¬/ê°€ì¡±/ë‚¯ì„  ì‚¬ëŒì¸ì§€ì— ë”°ë¼ ì„œë¡œ ë‹¤ë¥¸ ê°ì •ì„ íŒë‹¨í•œë‹¤." },
          { code: "4-1-2", text: "ìƒëŒ€ì˜ ì˜ë„(ì¥ë‚œ, ê³µê²©, ì‹¤ìˆ˜)ë¥¼ ê°ì •ê³¼ ì—°ê²°í•˜ì—¬ ë‹¤ë¥´ê²Œ ì´í•´í•œë‹¤." },
          { code: "4-1-3", text: "ë„ì›€/ë¬´ì‹œ/ë°©í•´ ë“± ìƒí˜¸ì‘ìš©ì˜ ì„±ê²©ì— ë”°ë¼ ê°ì •ì„ êµ¬ë¶„í•œë‹¤." },
          { code: "4-2-1", text: "ì¹­ì°¬Â·ì‘ì› ìƒí™©ì—ì„œëŠ” ê¸°ì¨Â·ìì‹ ê°ê³¼ ê°™ì€ ê°ì •ì„ ì„ íƒí•œë‹¤." },
          { code: "4-2-2", text: "ê±°ì ˆÂ·ë¹„ë‚œ ìƒí™©ì—ì„œëŠ” ì†ìƒí•¨Â·ì¢Œì ˆ ë“±ì˜ ê°ì •ì„ ì„ íƒí•œë‹¤." },
          { code: "4-2-3", text: "ê°ˆë“± ìƒí™©ì—ì„œ ì–‘ìª½ ì¸ë¬¼ì´ ê°ê° ëŠë‚„ ìˆ˜ ìˆëŠ” ê°ì •ì„ ì¶”ë¡ í•œë‹¤." }
        ]
      },
      {
        id: "sec5",
        title: "5. ì´ì•¼ê¸° ì „ì²´ íë¦„ ê¸°ë°˜ ê°ì • ì´í•´",
        items: [
          { code: "5-1-1", text: "ì´ì•¼ê¸°ì˜ ì‹œì‘Â·ì¤‘ê°„Â·ëì—ì„œ ê°ì •ì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŒì„ ì´í•´í•œë‹¤." },
          { code: "5-1-2", text: "ì‚¬ê±´ ì „í›„ì˜ ê°ì • ë³€í™”ë¥¼ ìì—°ìŠ¤ëŸ½ê²Œ ì—°ê²°í•œë‹¤." },
          { code: "5-1-3", text: "ì´ì•¼ê¸°ê°€ ê¸¸ì–´ì ¸ë„ ì¸ë¬¼ì˜ ê°ì •ì„ ê³„ì† ì¶”ì í•˜ë ¤ê³  í•œë‹¤." },
          { code: "5-2-1", text: "ê²‰ìœ¼ë¡œëŠ” í‰ì˜¨í•´ë„ ìƒí™© ë•Œë¬¸ì— ì†ìœ¼ë¡œ ë¶ˆì•ˆí•  ìˆ˜ ìˆìŒì„ ì´í•´í•œë‹¤." },
          { code: "5-2-2", text: "ë‘ ê°€ì§€ ê°ì •(ê¸°ì˜ì§€ë§Œ ê±±ì •ë¨ ë“±)ì„ ë™ì‹œì— ëŠë‚„ ìˆ˜ ìˆìŒì„ ì´í•´í•œë‹¤." },
          { code: "5-2-3", text: "ê°ì •ì´ ê²‰ìœ¼ë¡œ ë“œëŸ¬ë‚˜ì§€ ì•Šì„ ë•Œì—ë„ ì¶”ë¡ í•˜ë ¤ëŠ” ì‹œë„ë¥¼ ë³´ì¸ë‹¤." }
        ]
      },
      {
        id: "sec6",
        title: "6. ì˜¤ë‹µ ë¶„ì„ ë° í•™ìŠµ ë°˜ì‘",
        items: [
          { code: "6-1-1", text: "ë‘ë ¤ì›€â€“ê¹œì§ ë†€ëŒì„ ìì£¼ í˜¼ë™í•˜ì§€ ì•ŠëŠ”ë‹¤." },
          { code: "6-1-2", text: "ìŠ¬í””â€“ì‹¤ë§ì„ êµ¬ë¶„í•˜ë ¤ëŠ” ì‹œë„ë¥¼ ë³´ì¸ë‹¤." },
          { code: "6-1-3", text: "í™”ë‚¨â€“ì§œì¦, ê¸°ì¨â€“í¥ë¶„ ë“± ìœ ì‚¬ ê°ì •ì„ ì ì°¨ êµ¬ë¶„í•˜ê²Œ ëœë‹¤." },
          { code: "6-2-1", text: "ê°ì • ì´ìœ ì— ëŒ€í•œ ì„¤ëª…ì„ ë“¤ìœ¼ë©´ ì´í•´í•˜ë ¤ëŠ” íƒœë„ë¥¼ ë³´ì¸ë‹¤." },
          { code: "6-2-2", text: "ê°™ì€ ìœ í˜•ì˜ ì˜¤ë¥˜ê°€ ì ì°¨ ì¤„ì–´ë“œëŠ” ê²½í–¥ì´ ìˆë‹¤." },
          { code: "6-2-3", text: "ê°™ì€ ë¬¸ì œë¥¼ ë‹¤ì‹œ ì œì‹œí–ˆì„ ë•Œ ì •ë‹µìœ¼ë¡œ ìˆ˜ì •í•˜ëŠ” ê²½ìš°ê°€ ëŠ˜ì–´ë‚œë‹¤." }
        ]
      },
      {
        id: "sec7",
        title: "7. ì„ íƒ ê³¼ì •ì˜ ì¸ì§€ ì „ëµ ë° ì°¸ì—¬ë„",
        items: [
          { code: "7-1-1", text: "ë¬¸ì œê°€ ì œì‹œë˜ë©´ ìƒí™©ì„ í•œ ë²ˆ ë– ì˜¬ë¦¬ê±°ë‚˜ ë˜ì§šì–´ ë³´ë ¤ í•œë‹¤." },
          { code: "7-1-2", text: "ì„ íƒ ì „ ì‚¬ê±´ì˜ ë‹¨ì„œ(ë¬´ì—‡ì´ ìˆì—ˆëŠ”ì§€)ë¥¼ í•˜ë‚˜ ì´ìƒ ë– ì˜¬ë¦¬ê±°ë‚˜ ë§í•œë‹¤." },
          { code: "7-1-3", text: "ì¶©ë™ì ìœ¼ë¡œ ì„ íƒí•˜ê¸°ë³´ë‹¤ ë‹¨ì„œë¥¼ í™•ì¸í•˜ëŠ” ëª¨ìŠµì„ ë³´ì¸ë‹¤." },
          { code: "7-2-1", text: "â€œì™œ ê·¸ë ‡ê²Œ ê³¨ëì–´?â€ë¼ëŠ” ì§ˆë¬¸ì— ë‹¨ì„œ(ìƒí™©, í–‰ë™ ë“±) ê¸°ë°˜ ì„¤ëª…ì„ ì‹œë„í•œë‹¤." },
          { code: "7-2-2", text: "ë™í™” ë“£ê¸°ì™€ ê°ì • ì„ íƒ í™œë™ì— ì¼ì • ì‹œê°„ ì´ìƒ ì§‘ì¤‘ì„ ìœ ì§€í•œë‹¤." },
          { code: "7-2-3", text: "ì˜¤ë‹µì´ ë‚˜ì™€ë„ ê³¼ë„í•œ ê°ì • í­ë°œ ì—†ì´ í™œë™ì„ ì´ì–´ê°„ë‹¤." }
        ]
      }
    ];

    function createSection(section) {
      const card = document.createElement("div");
      card.className = "section-card";
      card.dataset.sectionId = section.id;

      const header = document.createElement("div");
      header.className = "section-header";

      const title = document.createElement("div");
      title.className = "section-title";
      title.textContent = section.title;

      const scoreInfo = document.createElement("div");
      scoreInfo.className = "section-score";
      scoreInfo.innerHTML = `
        ì„¹ì…˜ ì ìˆ˜: <span class="section-total" data-section="${section.id}">0</span>ì 
        Â· í‰ê·  <span class="section-avg" data-section="${section.id}">0.0</span>
        Â· ì‘ë‹µ <span class="section-count" data-section="${section.id}">0</span>ë¬¸í•­
      `;

      header.appendChild(title);
      header.appendChild(scoreInfo);

      const table = document.createElement("table");

      const thead = document.createElement("thead");
      const headRow = document.createElement("tr");
      const thItem = document.createElement("th");
      thItem.className = "item-header";
      thItem.textContent = "ë¬¸í•­";
      headRow.appendChild(thItem);

      for (let i = 0; i <= 3; i++) {
        const thScore = document.createElement("th");
        thScore.textContent = i + "ì ";
        headRow.appendChild(thScore);
      }
      const thNA = document.createElement("th");
      thNA.textContent = "N/A";
      headRow.appendChild(thNA);
      
      thead.appendChild(headRow);
      table.appendChild(thead);

      const tbody = document.createElement("tbody");

      section.items.forEach(item => {
        const row = document.createElement("tr");

        const tdLabel = document.createElement("td");
        tdLabel.className = "item-label";
        const codeSpan = document.createElement("span");
        codeSpan.className = "item-code";
        codeSpan.textContent = item.code;
        const textSpan = document.createElement("span");
        textSpan.textContent = item.text;
        tdLabel.appendChild(codeSpan);
        tdLabel.appendChild(textSpan);

        row.appendChild(tdLabel);
       
        for (let score = 0; score <= 3; score++) {
          
          const tdRadio = document.createElement("td");
          const wrapper = document.createElement("div");
          wrapper.className = "radio-group";

          const label = document.createElement("label");
          const input = document.createElement("input");
          input.type = "radio";
          input.name = item.code;
          input.value = score;
          input.dataset.sectionId = section.id;
          input.dataset.itemCode = item.code;
          input.dataset.toggleable = "true";

          label.appendChild(input);
          label.appendChild(document.createTextNode(String(score)));
          wrapper.appendChild(label);
          tdRadio.appendChild(wrapper);
          row.appendChild(tdRadio);
        }

        const tdNA = document.createElement("td");
        const wrapperNA = document.createElement("div");
        wrapperNA.className = "radio-group";

        const labelNA = document.createElement("label");
        const inputNA = document.createElement("input");
        inputNA.type = "radio";
        inputNA.name = item.code;
        inputNA.value = "na";
        inputNA.dataset.sectionId = section.id;
        inputNA.dataset.itemCode = item.code;
        inputNA.dataset.toggleable = "true";

        labelNA.appendChild(inputNA);
        labelNA.appendChild(document.createTextNode("N/A"));
        wrapperNA.appendChild(labelNA);
        tdNA.appendChild(wrapperNA);
        row.appendChild(tdNA)

        tbody.appendChild(row);
      });

      table.appendChild(tbody);
      card.appendChild(header);
      card.appendChild(table);

      const memoLabel = document.createElement("div");
      memoLabel.className = "memo-label";
      memoLabel.textContent = "ì„¹ì…˜ ë©”ëª¨ (ê°•ì  / ì–´ë ¤ì›€ / ê´€ì°° ì†Œê°)";
      const memo = document.createElement("textarea");
      memo.className = "memo";
      memo.dataset.sectionId = section.id;
      memo.placeholder = "ì˜ˆ: ìƒí™© ë‹¨ì„œëŠ” ì˜ í™œìš©í•˜ì§€ë§Œ, ëª¨í˜¸í•œ ìƒí™©ì—ì„œ ì¶”ë¡ ì´ ì–´ë ¤ì›€.";

      card.appendChild(memoLabel);
      card.appendChild(memo);

      return card;
    }

    function updateScores() {
let globalTotal = 0;
  let globalCount = 0;

  checklistData.forEach((section) => {
    let sectionTotal = 0;
    let sectionCount = 0;

    section.items.forEach((item) => {
      const checked = document.querySelector(`input[name="${item.code}"]:checked`);
      if (!checked) return;

      const val = checked.value;

      // N/A ì´ë©´ ì ìˆ˜/ë¬¸í•­ìˆ˜ ê³„ì‚°ì—ì„œ ì œì™¸
      if (val === "na") {
        return;
      }

      const numVal = parseInt(val, 10);
      if (!Number.isNaN(numVal)) {
        sectionTotal += numVal;
        sectionCount += 1;
      }
    });

    const sectionTotalElem = document.querySelector(
      `.section-total[data-section="${section.id}"]`
    );
    const sectionAvgElem = document.querySelector(
      `.section-avg[data-section="${section.id}"]`
    );
    const sectionCountElem = document.querySelector(
      `.section-count[data-section="${section.id}"]`
    );

    if (sectionTotalElem && sectionAvgElem && sectionCountElem) {
      sectionTotalElem.textContent = sectionTotal;
      sectionCountElem.textContent = sectionCount;
      sectionAvgElem.textContent =
        sectionCount > 0 ? (sectionTotal / sectionCount).toFixed(2) : "0.0";
    }

    globalTotal += sectionTotal;
    globalCount += sectionCount;
  });

  const globalTotalElem = document.getElementById("global-total");
  const globalAvgElem = document.getElementById("global-avg");
  const globalCountElem = document.getElementById("global-count");

  globalTotalElem.textContent = globalTotal;
  globalCountElem.textContent = globalCount;
  globalAvgElem.textContent =
    globalCount > 0 ? (globalTotal / globalCount).toFixed(2) : "0.0";
}


    function collectData() {
      const responses = {};
      checklistData.forEach(section => {
        section.items.forEach(item => {
          const checked = document.querySelector(`input[name="${item.code}"]:checked`);
          if (checked) {
            const v = checked.value;
            responses[item.code] = v === "na" ? "NA" : parseInt(v,10);
          }
        });
      });

      const sectionMemos = {};
      document.querySelectorAll("textarea.memo").forEach(textarea => {
        const secId = textarea.dataset.sectionId;
        sectionMemos[secId] = textarea.value || "";
      });

      const globalNotes = document.getElementById("global-notes").value || "";

      return {
        checklistVersion: "1.1-situation-based",
        savedAt: new Date().toISOString(),
        responses,
        sectionMemos,
        globalNotes
      };
    }

    function exportData() {
      const data = collectData();
      const json = JSON.stringify(data, null, 2);
      const blob = new Blob([json], { type: "application/json" });

      const dateStr = new Date().toISOString().slice(0, 10);
      const defaultName = `ê°ì •ì²´í¬ë¦¬ìŠ¤íŠ¸_${dateStr}.json`;
      const userFileName = window.prompt(
        "ì €ì¥í•  íŒŒì¼ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš” (í™•ì¥ì .json í¬í•¨ ë˜ëŠ” ì œì™¸ ê°€ëŠ¥)",
        defaultName
      );

      if(userFileName === null){
        return;
      }

      let finalName = userFileName.trim();
      if(finalName === ""){
        finalName = defaultName;
      }
      if(!finalName.toLowerCase().endsWith(".json")){
        finalName += ".json";
      }

      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = finalName;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    function applyData(data) {
      if (!data || !data.responses) return;

      // ì ìˆ˜
      Object.entries(data.responses).forEach(([code, val]) => {
        let selector;
        if(val ==="NA"){
          selector = `input[name = "${code}"][value="na"]`;
        }else{
          selector = `input[name = "${code}"][value="${val}"]`;
        }
        const input = document.querySelector(selector);
        if(input){
          input.checked = true;
          input.dataset.checked = "true";
        }
      });

      // ì„¹ì…˜ ë©”ëª¨
      if (data.sectionMemos) {
        Object.entries(data.sectionMemos).forEach(([secId, text]) => {
          const textarea = document.querySelector(
           `textarea.memo[data-section-id="${secId}"], textarea.memo[data-sectionid="${secId}"], textarea.memo[data-section-id="${secId}"]`
        );
        if (textarea) {
            textarea.value = text;
          }
        });
      }

      // ì¢…í•© ì˜ê²¬
      if (typeof data.globalNotes === "string") {
        document.getElementById("global-notes").value = data.globalNotes;
      }

      updateScores();
    }

    function init() {
      const container = document.getElementById("sections-container");
      checklistData.forEach(section => {
        const secElem = createSection(section);
        container.appendChild(secElem);
      });

      document.addEventListener("click", (e) => {
        const target = e.target;
        if(
          target &&
          target.matches("input[type='radio'][data-toggleable='true']")
        ){
          const name = target.name;
          const wasChecked = target.dataset.checked === "true";

          document
            .querySelectorAll(`input[type='radio'][name='${name}']`)
            .forEach((r)=> {
              r.dataset.checked = "false";
            });

          if(wasChecked){
            target.checked = false;
            target.dataset.checked = "false";
          }else{
            target.checked= true;
            target.dataset.checked = "true"
          }

          updateScores();
        }
    })

      document.getElementById("btn-export").addEventListener("click", exportData);

      const importInput = document.getElementById("file-import");
      importInput.addEventListener("change", (e) => {
        const file = e.target.files && e.target.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = (ev) => {
          try {
            const data = JSON.parse(ev.target.result);
            applyData(data);
          } catch (err) {
            alert("JSON íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
          } finally {
            importInput.value = "";
          }
        };
        reader.readAsText(file, "utf-8");
      });

      document.getElementById("btn-print").addEventListener("click", () => {
        window.print();
      });

      updateScores();
    }

    document.addEventListener("DOMContentLoaded", init);
  </script>
</body>
</html>
